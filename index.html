<!DOCTYPE html>
<html>
  <head>
    <style media="screen">
      html, body, canvas {
        margin: 0;
        padding: 0;
        border: 0;
      }

      .ui-loader {
        display: none;
      }

      canvas {
        width: 100%;
        height: 100%;
      }
    </style>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.js" charset="utf-8"></script>
  </head>
  <body>
    <canvas id="game-canvas"></canvas>


    <script src="lib/movingObject.js" charset="utf-8"></script>
    <script src="lib/utils.js" charset="utf-8"></script>
    <script src="lib/ship.js" charset="utf-8"></script>
    <script src="lib/asteroid.js" charset="utf-8"></script>
    <script src="lib/game.js" charset="utf-8"></script>
    <script src="lib/gameView.js" charset="utf-8"></script>
    <script src="lib/bullet.js" charset="utf-8"></script>
    <script src="lib/keymaster.js"></script>
    <script src="lib/gyronorm.complete.js"></script>

    <script>
      var canvasEl = document.getElementById("game-canvas");
      canvasEl.setAttribute("width", window.innerWidth);
      canvasEl.setAttribute("Height", window.innerHeight);
      $(window).on("resize", function() {
        setTimeout(function() {
          canvasEl.setAttribute("Height", window.innerHeight);
        }, 10);
      });
      var ctx = canvasEl.getContext('2d');
      Asteroids = Asteroids || {};
      var game = new Asteroids.Game(canvasEl.width, canvasEl.height);
      var gameView = new Asteroids.GameView(game, ctx);
      gameView.start();
    </script>

    <script type="text/javascript">
        var gn = new GyroNorm();

        gn.init({frequency: 1000/30}).then(function(){
          var timeouts = []
            gn.start(function(data){
                // Process:
                // data.do.alpha    ( deviceorientation event alpha value )
                // data.do.beta     ( deviceorientation event beta value )
                // data.do.gamma    ( deviceorientation event gamma value )
                // data.do.absolute ( deviceorientation event absolute value )



                // data.dm.x        ( devicemotion event acceleration x value )
                // data.dm.y        ( devicemotion event acceleration y value )
                // data.dm.z        ( devicemotion event acceleration z value )

                // data.dm.gx       ( devicemotion event accelerationIncludingGravity x value )
                // data.dm.gy       ( devicemotion event accelerationIncludingGravity y value )
                // data.dm.gz       ( devicemotion event accelerationIncludingGravity z value )

                // data.dm.alpha    ( devicemotion event rotationRate alpha value )
                // data.dm.beta     ( devicemotion event rotationRate beta value )
                // data.dm.gamma    ( devicemotion event rotationRate gamma value )

                // game.allObjects().forEach(function (obj) {
                //   obj.vel[0] += data.do.alpha / 10000;
                //   obj.vel[1] += data.do.beta / 10000;
                //
                // });
                game.ship.power([((data.dm.gamma > 0) - (data.dm.gamma < 0)) / 1,((data.dm.beta > 0) - (data.dm.beta < 0)) / 1]);
                // game.ship.accel = ;
                // game.ship.vel = game.ship.vel[0] == 0 && game.ship.vel[1] == 0 ? [Number.MIN_VALUE, Number.MIN_VALUE] : game.ship.vel;
            });
        }).catch(function(e){
          // Catch if the DeviceOrientation or DeviceMotion is not supported by the browser or device
        });
    </script>
  </body>
</html>
